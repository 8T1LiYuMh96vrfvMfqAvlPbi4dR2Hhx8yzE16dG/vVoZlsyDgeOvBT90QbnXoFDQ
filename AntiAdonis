local State = {
    Detected = nil,
    Kill = nil,
    DEBUG = true,
}

for _, obj in getgc(true) do
    if typeof(obj) == 'table' then
        local det = rawget(obj, 'Detected')
        local kil = rawget(obj, 'Kill')

        -- Match exact Adonis structure
        if typeof(det) == 'function' and not State.Detected then
            State.Detected = det
        end
        if
            rawget(obj, 'Variables')
            and rawget(obj, 'Process')
            and typeof(kil) == 'function'
            and not State.Kill
        then
            State.Kill = kil
        end
    end
end

if State.Detected then
    hookfunction(
        State.Detected,
        newcclosure(function(Action, Info, NoCrash)
            if State.DEBUG then
                warn(
                    '[Adonis] Detected blocked:',
                    Action or 'nil',
                    Info or 'nil'
                )
            end
            return true -- All checks pass
        end)
    )
    print('[Anti-Adonis] Detected hooked')
end

if State.Kill then
    hookfunction(
        State.Kill,
        newcclosure(function(Info)
            if State.DEBUG then
                warn('[Adonis] Kill blocked:', Info or 'nil')
            end
            -- Do nothing
        end)
    )
    print('[Anti-Adonis] Kill hooked')
end

setthreadidentity(7)
print('[Anti-Adonis] LOADED â€“ REMOTE SPY SAFE')
